import{_ as n,c as t,e as a,o as e}from"./app-Djabw3S-.js";const o={};function p(c,s){return e(),t("div",null,[...s[0]||(s[0]=[a(`<h1 id="操作日志查询接口文档-1-0-1" tabindex="-1"><a class="header-anchor" href="#操作日志查询接口文档-1-0-1"><span>操作日志查询接口文档 1.0.1</span></a></h1><ul><li><strong>Controller</strong>: <code>Inspur.Abp.Platform.ApiLogs.LogController</code></li><li><strong>Base Route</strong>: <code>/api/platform/log</code></li><li><strong>Remote Service Name</strong>: <code>PlatformLog</code></li><li><strong>Namespaces Referenced</strong>: <code>Inspur.Abp.Platform.ApiLogs</code></li></ul><hr><h2 id="_1-get-api-platform-log" tabindex="-1"><a class="header-anchor" href="#_1-get-api-platform-log"><span>1. GET <code>/api/platform/log</code></span></a></h2><p>分页查询日志记录。</p><h3 id="请求" tabindex="-1"><a class="header-anchor" href="#请求"><span>请求</span></a></h3><ul><li><strong>Method</strong>: <code>GET</code></li><li><strong>Query Parameters</strong>: <code>LogPagedAndSortedResultRequestDto</code><table><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td><code>SkipCount</code></td><td><code>int</code></td><td>跳过条数，默认 0</td></tr><tr><td><code>MaxResultCount</code></td><td><code>int</code></td><td>返回条数，默认 10</td></tr><tr><td><code>Sorting</code></td><td><code>string</code></td><td>排序字段，如 <code>ActionTime DESC</code></td></tr><tr><td><code>Filter</code></td><td><code>string</code></td><td>全局模糊查询关键字</td></tr><tr><td><code>UserId</code></td><td><code>Guid?</code></td><td>过滤指定用户</td></tr><tr><td><code>DepartmentId</code></td><td><code>Guid?</code></td><td>过滤指定部门</td></tr><tr><td><code>UserName</code></td><td><code>string</code></td><td>过滤用户名（模糊）</td></tr><tr><td><code>RoleName</code></td><td><code>string</code></td><td>过滤角色名称（模糊）</td></tr><tr><td><code>YkzUid</code></td><td><code>string</code></td><td>过滤愉快政 UID（模糊）</td></tr><tr><td><code>ActionModule</code></td><td><code>string</code></td><td>过滤模块（模糊）</td></tr><tr><td><code>ActionContent</code></td><td><code>string</code></td><td>过滤操作描述（模糊）</td></tr><tr><td><code>ActionType</code></td><td><code>string</code></td><td>过滤操作类型（模糊）</td></tr><tr><td><code>ExpandInformation</code></td><td><code>string</code></td><td>过滤扩展信息（模糊）</td></tr><tr><td><code>ActionStatus</code></td><td><code>bool?</code></td><td>过滤是否成功</td></tr><tr><td><code>OperatingEquipment</code></td><td><code>string</code></td><td>过滤设备信息（模糊）</td></tr><tr><td><code>UserAgent</code></td><td><code>string</code></td><td>过滤 UserAgent（模糊）</td></tr><tr><td><code>Ip</code></td><td><code>string</code></td><td>过滤 IP 地址（模糊）</td></tr><tr><td><code>StartTime</code></td><td><code>DateTime?</code></td><td>操作起始时间（含）</td></tr><tr><td><code>EndTime</code></td><td><code>DateTime?</code></td><td>操作结束时间（含）</td></tr></tbody></table></li></ul><h3 id="响应" tabindex="-1"><a class="header-anchor" href="#响应"><span>响应</span></a></h3><ul><li><strong>类型</strong>: <code>PagedResultDto&lt;LogItemDto&gt;</code><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;totalCount&quot;</span><span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;items&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">    <span class="token punctuation">{</span></span>
<span class="line">      <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GUID&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;userId&quot;</span><span class="token operator">:</span> <span class="token string">&quot;GUID&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;userName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;roles&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;string&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;ykzUid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;actionModule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;actionContent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;actionType&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;actionStatus&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;actionTime&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2025-12-08T03:00:00Z&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;operatingEquipment&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;userAgent&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;ip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token property">&quot;expandInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span></span>
<span class="line">      ...  <span class="token comment">// 其他 LogItemDto 字段</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="_2-post-api-platform-log-create" tabindex="-1"><a class="header-anchor" href="#_2-post-api-platform-log-create"><span>2. POST <code>/api/platform/log/create</code></span></a></h2><p>创建一条指定模块/操作的日志记录，使用当前登录用户与请求上下文信息。</p><h3 id="请求-1" tabindex="-1"><a class="header-anchor" href="#请求-1"><span>请求</span></a></h3><ul><li><strong>Method</strong>: <code>POST</code></li><li><strong>Body</strong>: 按当前 Controller 签名需要分别传递 <code>modelName</code> 和 <code>actionName</code>。 <blockquote><p><strong>建议</strong>：使用一个 DTO 容器进行序列化，例如：</p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">{</span></span>
<span class="line">  <span class="token property">&quot;modelName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;任务驾驶舱&quot;</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token property">&quot;actionName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;操作描述&quot;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote></li></ul><h3 id="响应-1" tabindex="-1"><a class="header-anchor" href="#响应-1"><span>响应</span></a></h3><ul><li><strong>类型</strong>: <code>void</code>（执行成功返回 <code>200 OK</code>，无响应体）。</li></ul><hr><h2 id="_3-get-api-platform-log-user-login-log-statistics" tabindex="-1"><a class="header-anchor" href="#_3-get-api-platform-log-user-login-log-statistics"><span>3. GET <code>/api/platform/log/user-login-log-statistics</code></span></a></h2><p>统计登录相关数据。</p><h3 id="请求-2" tabindex="-1"><a class="header-anchor" href="#请求-2"><span>请求</span></a></h3><ul><li><strong>Method</strong>: <code>GET</code></li><li><strong>Query Parameters</strong>: 无</li></ul><h3 id="响应-2" tabindex="-1"><a class="header-anchor" href="#响应-2"><span>响应</span></a></h3><ul><li><p><strong>类型</strong>: <code>List&lt;NameValue&lt;int&gt;&gt;</code></p><ul><li>典型键值： <table><thead><tr><th>Key</th><th>含义</th></tr></thead><tbody><tr><td><code>today</code></td><td>当天（00:00-23:59）登录次数</td></tr><tr><td><code>vpn</code></td><td>IP 包含 <code>23.99.94.200</code> 的登录次数</td></tr><tr><td><code>outNetwork</code></td><td>非 <code>23.99.94.200</code> IP 的登录次数</td></tr></tbody></table></li></ul><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json"><pre><code class="language-json"><span class="line"><span class="token punctuation">[</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;today&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">58</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vpn&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;outNetwork&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token number">46</span> <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><hr><h2 id="_4-get-api-platform-log-login-list" tabindex="-1"><a class="header-anchor" href="#_4-get-api-platform-log-login-list"><span>4. GET <code>/api/platform/log/login-list</code></span></a></h2><p>分页获取 <code>/connect/token</code> 登录日志。</p><h3 id="请求-3" tabindex="-1"><a class="header-anchor" href="#请求-3"><span>请求</span></a></h3><ul><li><strong>Method</strong>: <code>GET</code></li><li><strong>Query Parameters</strong>: <code>LogPagedAndSortedResultRequestDto</code><ul><li>与“分页查询日志”相同，但自动限定 <code>ExpandInformation</code> 包含 <code>/connect/token</code>。</li><li>常用过滤字段：<code>UserName</code>、<code>YkzUid</code>、<code>OperatingEquipment</code>、<code>UserAgent</code>、<code>Ip</code>、<code>StartTime</code>、<code>EndTime</code>。</li></ul></li></ul><h3 id="响应-3" tabindex="-1"><a class="header-anchor" href="#响应-3"><span>响应</span></a></h3><ul><li><strong>类型</strong>: <code>PagedResultDto&lt;LogItemDto&gt;</code>（同上）。</li></ul><hr><h2 id="备注" tabindex="-1"><a class="header-anchor" href="#备注"><span>备注</span></a></h2><ol><li>Controller 中标记 <code>[NonAction]</code> 的方法（<code>GetAsync</code>、<code>CreateAsync</code>、<code>UpdateAsync</code>、<code>DeleteAsync</code>）不会对外暴露；实际调用走内部应用服务。</li><li><code>CreateLogAsync</code> 调用了 <code>LogAppService</code>： <ul><li>自动填充当前用户的部门、角色、愉快政 UID。</li><li>使用 <code>HttpContext</code> 获取 <code>User-Agent</code> 与 <code>IP</code>。</li><li>最终委托 <code>ILogManager</code> 落库。</li></ul></li><li>若需要在 Swagger 等工具中正常使用 <code>POST /create</code>，建议改造为接收 DTO 或单个对象。</li></ol>`,33)])])}const l=n(o,[["render",p]]),r=JSON.parse('{"path":"/ops/%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%951.0.1.html","title":"操作日志查询接口文档 1.0.1","lang":"zh-CN","frontmatter":{},"git":{"updatedTime":1766027024000,"contributors":[{"name":"2553519066","username":"","email":"2553519066@qq.com","commits":1}],"changelog":[{"hash":"73daec44bb6b31f18393acc147f033664e6c8003","time":1766027024000,"email":"2553519066@qq.com","author":"2553519066","message":"1"}]},"filePathRelative":"ops/日志记录1.0.1.md"}');export{l as comp,r as data};
