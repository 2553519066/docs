(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chat-chat"],{"0120":function(e,t,i){"use strict";var a=i("29f7"),n=i.n(a);n.a},"29f7":function(e,t,i){var a=i("cab1");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("967d").default;n("5feb9a4c",a,!0,{sourceMap:!1,shadowMode:!1})},"3bd1":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return s})),i.d(t,"a",(function(){return a}));var a={customNavbar:i("6c8f").default,uniPopup:i("defc").default},n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("custom-navbar",{attrs:{title:"协助问诊",isBg:!1}}),a("v-uni-view",{staticClass:"info",staticStyle:{"margin-bottom":"10rpx"}},[e._v(e._s(e.info))]),a("v-uni-scroll-view",{staticClass:"chat-list",staticStyle:{"max-height":"calc(100vh - 450rpx)"},attrs:{"scroll-y":!0,"scroll-into-view":e.scrollToMessageId,"scroll-with-animation":!0}},[a("v-uni-view",{staticStyle:{padding:"10rpx 20rpx 0rpx 40rpx"}},[a("v-uni-view",{staticStyle:{padding:"0rpx 46rpx 0rpx 24rpx",width:"466rpx",height:"236rpx",background:"#FFFFFF",display:"flex","flex-direction":"column","border-radius":"28rpx 28rpx 28rpx 0rpx"}},[a("v-uni-view",{staticStyle:{height:"84rpx",width:"100%",position:"relative",overflow:"hidden"}},[a("v-uni-image",{staticStyle:{width:"112rpx",height:"116rpx",position:"absolute",left:"0rpx",top:"0rpx"},attrs:{src:"/static/chat/animeDoctor.png",mode:""}}),a("v-uni-image",{staticStyle:{width:"224rpx",height:"64rpx",position:"absolute",left:"0rpx",top:"24rpx","z-index":"99"},attrs:{src:"/static/chat/hi.png",mode:""}})],1),a("v-uni-view",{staticStyle:{"font-size":"28rpx",color:"#3B3B3B","line-height":"40rpx","font-weight":"500","margin-top":"8rpx"}},[e._v("我是您的助手，我可以根据您和患者的对话录音转换成电子病历和处方建议")])],1),e._l(3,(function(t,i){return a("v-uni-view",{key:i,staticClass:"single-user-chat"},[a("v-uni-view",{staticClass:"user-message"},[a("v-uni-view",{staticClass:"user-message-top"},[a("v-uni-view",{staticClass:"title"},[e._v("和张三的医患对话")]),a("v-uni-view",{staticClass:"user-audio-bag"},[a("v-uni-image",{staticClass:"play",attrs:{src:"/static/chat/audio-play.png",mode:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.playMusic.apply(void 0,arguments)}}}),a("v-uni-view",{staticClass:"user-music"},e._l(18,(function(t,i){return a("v-uni-view",{key:i,class:["lab",e.userMusic?"lab-active":""]})})),1),a("v-uni-view",{staticClass:"music-time"},[e._v("00:15")])],1)],1),a("v-uni-view",{staticClass:"user-message-text"},[e._v("医生我头痛是怎么回事？你头痛发生的位置在哪里？耳朵上面，是突然发生还是已经持续了一段时间？持续了一段时间，头痛的程度是否在逐渐加重？没有逐渐加重，姓名年龄，蒋成胜31。请结合以上医患对话生成电子病历和处方建议")])],1)],1)})),e._l(e.contentList,(function(t,n){return a("v-uni-view",{key:n,staticStyle:{position:"relative"}},[!t.type&&e.contentList[n].message?a("v-uni-image",{staticStyle:{width:"80rpx",position:"absolute",left:"20rpx"},attrs:{src:i("8ce9"),mode:"widthFix"}}):e._e(),a("v-uni-view",{staticClass:"chat-message",staticStyle:{margin:"60rpx 0","scroll-y":"true"},attrs:{id:"message-"+n}},[a("v-uni-view",{staticClass:"answer",staticStyle:{display:"flex"},style:t.type?{marginLeft:"15vw",display:"flex",justifyContent:"flex-end"}:{marginLeft:"15vw"}},[2!==t.type&&e.contentList[n].message?a("v-uni-text",{staticClass:"formatted-text",staticStyle:{padding:"20rpx","border-radius":"16rpx",position:"relative"},style:t.type?1==t.type?{backgroundColor:"#ffffff",color:"rgba(47, 180, 251, 1)"}:"":{backgroundColor:"rgba(47, 180, 251, 1)",color:"#f6f6f6f"},on:{touchstart:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAndDeL(n)},touchend:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAndDeL1(n)}}},[e._v(e._s(t.message)),t.type?e._e():a("v-uni-view",{staticStyle:{"font-size":"20rpx",display:"flex","flex-direction":"row-reverse",color:""},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.getTtoA(t.message)}}},[a("v-uni-image",{staticStyle:{width:"40rpx"},attrs:{src:i("23e0"),mode:"widthFix"}})],1),e.showDeleteBtn(n)?a("v-uni-view",{staticClass:"showDel",style:t.type?{right:"100rpx"}:{left:"100rpx"}},[a("v-uni-view",{staticClass:"copyOrdel",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.copy(t.message)}}},[a("v-uni-image",{staticStyle:{width:"28rpx"},attrs:{src:i("7c7e"),mode:"widthFix"}}),a("v-uni-view",{staticStyle:{color:"#000"}},[e._v("复制")])],1),a("v-uni-view",{staticStyle:{"background-color":"#e2e2e2",height:"1rpx",width:"100%",margin:"10rpx 0"}}),a("v-uni-view",{staticClass:"copyOrdel",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.del(n,t.id)}}},[a("v-uni-image",{staticStyle:{width:"28rpx"},attrs:{src:i("2ac8"),mode:"widthFix"}}),a("v-uni-view",{staticStyle:{color:"red"}},[e._v("删除")])],1)],1):e._e()],1):e._e(),2==t.type&&e.contentList[n].message?a("v-uni-view",{staticStyle:{color:"black","background-color":"aquamarine",width:"150rpx","border-radius":"16rpx",display:"flex","justify-content":"center",padding:"10rpx 0"}},[a("v-uni-text",{staticStyle:{"font-size":"35rpx"},on:{touchstart:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAndDeL(n)},touchend:function(t){arguments[0]=t=e.$handleEvent(t),e.copyAndDeL1(n)}}},[e._v("''"+e._s(t.timeNum))]),a("v-uni-view",{staticClass:"voice_icon ",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.audioPlay(t)}}},[a("v-uni-view",{staticClass:"voice_icon voice_icon_right ",class:[{voice_icon_right_an:t.isRead}],staticStyle:{position:"relative"}}),e.showDeleteBtn(n)?a("v-uni-view",{staticClass:"showDel",staticStyle:{right:"100rpx"}},[a("v-uni-view",{staticClass:"copyOrdel"},[a("v-uni-image",{staticStyle:{width:"28rpx"},attrs:{src:i("2ac8"),mode:"widthFix"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.del(n,e.id)}}}),a("v-uni-view",{staticStyle:{color:"red"}},[e._v("删除")])],1)],1):e._e()],1)],1):e._e()],1)],1),t.type&&e.contentList[n].message?a("v-uni-image",{staticStyle:{width:"80rpx",position:"absolute",right:"20rpx",top:"0rpx"},attrs:{src:i("d55c"),mode:"widthFix"}}):e._e()],1)})),a("v-uni-view",{},[e.last&&e.response?a("v-uni-view",{staticClass:"chat-message",staticStyle:{margin:"60rpx 0","scroll-y":"true"},attrs:{id:"mesList1"}},[a("v-uni-image",{staticStyle:{width:"80rpx",position:"absolute",left:"20rpx"},attrs:{src:i("8ce9"),mode:"widthFix"}}),e.last&&e.response?a("v-uni-view",{staticClass:"answer",staticStyle:{display:"flex","margin-left":"15vw"}},[a("v-uni-view",{staticStyle:{padding:"20rpx","border-radius":"16rpx","background-color":"rgba(47, 180, 251, 1)",color:"#f6f6f6"}},[a("v-uni-text",[e._v(e._s(e.response))])],1)],1):e._e()],1):e._e()],1)],2)],1),e.recording?e._e():a("v-uni-view",{staticStyle:{position:"fixed",bottom:"0rpx",display:"flex","flex-direction":"column","align-items":"center",width:"100%","padding-bottom":"50rpx","z-index":"99",background:"#f3f3f3","padding-top":"10rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.startVoice.apply(void 0,arguments)}}},[a("v-uni-view",{staticStyle:{width:"58rpx",height:"58rpx","border-radius":"50%",background:"#ffffff",border:"44rpx solid #2FB3FB"}}),a("v-uni-view",{staticStyle:{"font-size":"32rpx",color:"#000000","margin-top":"10rpx","line-height":"32rpx"}},[e._v("开始录音")])],1),e.recording||e.popupShow?a("v-uni-view",{staticStyle:{width:"100%",height:"100vh",position:"fixed",top:"0rpx",left:"0rpx",right:"0rpx",bottom:"0rpx","z-index":"999",background:"#ffffff",display:"flex","flex-direction":"column","align-items":"center"}},[a("v-uni-view",{staticStyle:{"font-size":"50rpx","margin-top":"120rpx",color:"#333",width:"100%","text-align":"center","font-weight":"bold"}},[e._v("00:"+e._s(e.formattedTime))]),a("v-uni-text",{staticStyle:{"font-size":"26rpx",color:"#888888","margin-top":"10rpx"}},[e._v("高品质音质")]),a("v-uni-view",{staticClass:"waveform"},[a("v-uni-view",{staticClass:"avoiceprint-music"},e._l(20,(function(e,t){return a("v-uni-view",{key:t,staticClass:"bar"})})),1)],1),a("v-uni-view",{staticStyle:{position:"absolute",bottom:"0rpx",left:"0rpx",width:"100%",height:"304rpx",display:"flex","align-items":"center"}},[a("v-uni-image",{staticStyle:{width:"136rpx",height:"136rpx","margin-left":"48rpx"},attrs:{src:e.isPaused?"/static/chat/continueImg.png":"/static/chat/pauseImg.png",mode:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getpause.apply(void 0,arguments)}}}),a("v-uni-image",{staticStyle:{width:"136rpx",height:"136rpx","margin-left":"124rpx"},attrs:{src:"/static/chat/completeImg.png",mode:""},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.endVoice.apply(void 0,arguments)}}})],1),a("uni-popup",{ref:"titlePopup",attrs:{type:"center","mask-click":!1}},[a("v-uni-view",{staticStyle:{padding:"50rpx",width:"610rpx",background:"#ffffff","border-radius":"40rpx",display:"flex","flex-direction":"column","align-items":"center"}},[a("v-uni-view",{staticStyle:{"font-size":"36rpx",color:"#000000","font-weight":"500","text-align":"center"}},[e._v("生成电子病历和处方")]),a("v-uni-input",{staticStyle:{padding:"0rpx 20rpx",width:"570rpx",height:"100rpx",border:"2rpx solid blue","margin-top":"30rpx","border-radius":"36rpx",background:"#e2e2e2"},attrs:{type:"text",placeholder:"请输入对话名称"},model:{value:e.dialogueName,callback:function(t){e.dialogueName=t},expression:"dialogueName"}}),a("v-uni-view",{staticStyle:{width:"100%",display:"flex","align-items":"center","justify-content":"space-between","margin-top":"120rpx"}},[a("v-uni-view",{staticStyle:{width:"294rpx",height:"92rpx","line-height":"92rpx","text-align":"center",background:"#f6f6f6",color:"#908e8e","font-size":"32rpx","border-radius":"84rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.delAudio.apply(void 0,arguments)}}},[e._v("删除")]),a("v-uni-view",{staticStyle:{width:"294rpx",height:"92rpx","line-height":"92rpx","text-align":"center",background:"#2FB3FB",color:"#ffffff","font-size":"32rpx","border-radius":"84rpx"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.generate.apply(void 0,arguments)}}},[e._v("生成病例/处方")])],1)],1)],1)],1):e._e()],1)},s=[]},"5d77":function(e,t,i){"use strict";i.r(t);var a=i("3bd1"),n=i("9ffd");for(var s in n)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(s);i("0120");var o=i("828b"),r=Object(o["a"])(n["default"],a["b"],a["c"],!1,null,"bec0200c",null,!1,a["a"],void 0);t["default"]=r.exports},"611d":function(e,t,i){"use strict";i("6a54");var a=i("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(i("2634")),s=a(i("2fdc"));i("bf0f"),i("7a76"),i("c9b5"),i("aa9c"),i("c223"),i("795c"),i("18f7"),i("de6c"),i("dc89"),i("2425"),i("64aa"),i("5c47"),i("2c10"),i("2797"),i("4626"),i("5ac7"),i("d4b5");a(i("21f5"));var o=a(i("784c")),r={components:{tuiModal:o.default},data:function(){return{showDelAndcopy:!1,mess:"",response:[],last:!1,isMember:0,text:"",audio:!0,recording:!1,PointY:0,Tclist:[],showtext:!0,isTall:!1,info:"",title:"",jq:"",id:"",contentList:[],scrollToMessageId:"",textToShow:"",fullText:"",currentTextIndex:0,token:"",isShow:!1,tempFilePaths:"",aiType:"",payopen:0,userId:"",mediaRecorder:"",isSend:!0,audioUser:"",myAudio:null,session_id:"",allMessages:[],controller:new AbortController,isStopped:!1,longPressTimer:"",longPressIndex:"",formattedTime:"00.00",elapsedTime:0,timerInterval:null,isPaused:!1,audioBlob:null,dialogueName:"",popupShow:!1,audioChunks:[],userMusic:!1,inputMessage:""}},onLoad:function(e){if(this.myAudio=uni.createInnerAudioContext(),this.userId=uni.getStorageSync("userId"),this.getBaidujq(),e.data){console.log("传参",e.data);var t=JSON.parse(decodeURIComponent(e.data));this.info=t.info,uni.setNavigationBarTitle({title:t.title}),this.title=t.title,this.id=t.id,this.aiType=t.aiType}this.getList(this.aiType),this.getIsVip(),this.generateRandomStringWithSpecialChars(32)},onUnload:function(){this.myAudio.stop(),this.myAudio=null},methods:{playMusic:function(){this.userMusic=!0},showDeleteBtn:function(e){return this.longPressIndex===e},copyAndDeL:function(e){var t=this;this.longPressTimer=setTimeout((function(){t.longPressIndex=e}),1e3)},copyAndDeL1:function(e){clearTimeout(this.longPressTimer),this.longPressIndex===e&&(this.showDelAndcopy=!0)},del:function(e,t){this.contentList[e].message=null,uni.request({url:"https://www.tuozhen.com/application-docapp/deleteChatById.tz",data:{ids:t},success:function(e){e.data&&(uni.showToast({title:"删除成功"}),setTimeout((function(){uni.hideToast()}),2e3))}}),console.log(t)},getTsc:function(e){var t=this;uni.request({url:"https://api.sensenova.cn/v1/llm/chat/sessions",method:"post",data:{system_prompt:[{content:"假设你是一位经验丰富且非常谨慎的的AI医生，会通过和患者进行多次的问答来明确自己的猜测，并且每次只能提一个问题，最终只会推荐相应的检验、检查、就诊科室以及疑似的诊断。回答问题的字数最好都控制在100以内，回答格式如以下示例：\n\t\t\t\t\t\tXXXX：\n\t\t\t\t\t\t1.xxxxx\n\t\t\t\t\t\t2.xxxx\n\t\t\t\t\t\t3.xxxx\n\t\t\t\t\t\t",role:"system"}]},header:{Authorization:"Bearer "+this.jq,"Content-Type":"application/json"},success:function(e){t.session_id=e.data.session_id}})},audioPlay:function(e){this.myAudio.src=e.audioUrl,this.myAudio.play()},getTtoA:function(e){this.myAudio.stop(),this.myAudio.src="https://tsn.baidu.com/text2audio?tex="+encodeURIComponent(e)+"&lan=zh&cuid=1234567JAVA&ctp=1&tok="+this.token+"&spd=5&pit=5&vol=5&=3",this.myAudio.play()},getBaidujq:function(){var e=this;uni.request({url:"https://www.tuozhen.com/application-usrapp/getBaiDuToken.tz",success:function(t){e.token=t.data.result}})},generateRandomStringWithSpecialChars:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i="",a=t.length,n=0;n<e;n++)i+=t.charAt(Math.floor(Math.random()*a));uni.getStorageSync("cuid")||uni.setStorageSync("cuid",i)},generate:function(){this.dialogueName?(this.elapsedTime=0,this.popupShow=!1,this.$refs.titlePopup.close(),this.getAtot(this.audioBlob)):uni.showToast({title:"请输入对话名称"})},delAudio:function(){this.elapsedTime=0,this.audioChunks=[],this.audioBlob=null,this.$refs.titlePopup.close(),this.popupShow=!1},getAtot:function(e){var t=this;console.log(111);var i=new FormData,a=(new Date).getTime();i.append("file",e,a+".wav"),fetch("https://www.tuozhen.com/application-usrapp/getServerApinew.tz",{method:"POST",body:i}).then((function(e){if(!e.ok)throw new Error("Network response was not ok");return e.json()})).then((function(e){t.audioBlob=null,t.audioChunks=[];var i=JSON.parse(e.result);t.text=i.result[0],t.sendBtn(!0)})).catch((function(e){console.error("文件上传失败:",e)}))},getPayopen:function(){var e=this;this.$api.common.getPayopen(2).then((function(t){e.payopen=t.data.result}))},getList:function(e,t){var i=this;uni.request({url:"https://www.tuozhen.com/application-usrapp/getUserChatInfoList.tz?userId="+this.userId+"&aiType="+e+"&limit=0",method:"get",success:function(e){if(console.log("返回",e),200==e.data.code){if(i.contentList=e.data.result.list,t){var a=i.contentList[t];i.Audio.paused?i.playAudio(a):i.stopAudio(a)}i.$nextTick((function(){i.scrollToMessageId="message-"+(i.contentList.length-1)}))}}})},preview:function(e){uni.navigateTo({url:"/pages/checkPdf/checkPdf?url="+e})},getIsVip:function(){var e=this;uni.request({url:"https://www.tuozhen.com/application-usrapp/queryUserIsMember.tz?userId="+this.userId,method:"get",success:function(t){e.isMember=t.data.result.isMember}})},startRecording:function(){var e=this;return(0,s.default)((0,n.default)().mark((function t(){var i;return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!navigator.mediaDevices.getUserMedia){t.next=16;break}return t.prev=1,t.next=4,navigator.mediaDevices.getUserMedia({audio:!0});case 4:i=t.sent,e.mediaRecorder=new MediaRecorder(i),e.mediaRecorder.ondataavailable=function(t){e.audioChunks.push(t.data)},e.mediaRecorder.onstop=function(){e.handleRecordingStop()},setTimeout((function(){e.mediaRecorder.start(),e.startTimer()}),300),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](1),console.error("获取媒体设备失败:",t.t0);case 14:t.next=17;break;case 16:console.log("浏览器不支持MediaDevices");case 17:case"end":return t.stop()}}),t,null,[[1,11]])})))()},startTimer:function(){var e=this;this.timerInterval||(this.timerInterval=setInterval((function(){e.elapsedTime++,e.updateFormattedTime()}),1e3))},stopTimer:function(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)},updateFormattedTime:function(){var e=Math.floor(this.elapsedTime/60),t=this.elapsedTime%60;this.formattedTime="".concat(String(e).padStart(2,"0"),":").concat(String(t).padStart(2,"0"))},handleRecordingStop:function(){clearInterval(this.timerInterval);var e=new Blob(this.audioChunks,{type:"audio/webm; codecs=opus"});this.audioBlob=e,this.audioSrc=URL.createObjectURL(e),console.log("录音",this.audioSrc)},startVoice:function(e){var t=this;return(0,s.default)((0,n.default)().mark((function i(){return(0,n.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!t.isTall){i.next=2;break}return i.abrupt("return",uni.showToast({title:"请稍后..."}));case 2:t.isSend=!0,t.timerInterval&&(clearTimeout(t.timerInterval),t.timerInterval=null),t.recording||(t.recording=!0,t.startRecording(),console.log("这是什么",e.touches[0].clientY),t.PointY=e.touches[0].clientY);case 5:case"end":return i.stop()}}),i)})))()},getpause:function(){console.log("暂停录音",this.mediaRecorder.state),this.isPaused?this.mediaRecorder&&"paused"===this.mediaRecorder.state&&(this.mediaRecorder.resume(),this.startTimer(),this.isPaused=!1):this.mediaRecorder&&"recording"===this.mediaRecorder.state&&(this.mediaRecorder.pause(),this.isPaused=!0,this.stopTimer())},endVoice:function(){var e=this;return(0,s.default)((0,n.default)().mark((function t(){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.mediaRecorder&&e.recording&&(e.elapsedTime>0?(e.mediaRecorder.stop(),e.popupShow=!0,e.recording=!1,e.formattedTime="00:00",clearInterval(e.timerInterval),e.timerInterval=null,e.$refs.titlePopup.open()):uni.showToast({title:"录音时间需要大于1秒"}),console.log("状态",e.popupShow,e.recording,e.elapsedTime));case 2:case"end":return t.stop()}}),t)})))()},showTextCharByChar:function(e){var t=this;this.currentTextIndex=0,this.textToShow="";var i=setInterval((function(){Number(t.currentTextIndex)<e.length?(t.textToShow+=e[t.currentTextIndex],t.currentTextIndex++):clearInterval(i)}),100)},senNow:function(){console.log("立即生成")},copy:function(e){var t=document.createElement("input");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),t.className="oInput",t.style.display="none",uni.showToast({title:"复制成功"}),setTimeout((function(){uni.hideToast()}),2e3)},focus:function(){this.showtext=!1},blur:function(){this.showtext=!0},getTclist:function(){var e=this;this.$api.common.getTcList().then((function(t){e.Tclist=t.data.result.list}))},getDelta:function(e){var t=e.match(/delta/g),i="";if(t.length>1){var a=e.split("data:");return a.forEach((function(e,t){if(t>0){var a=JSON.parse(e);i+=a.data.delta}})),"**"==i&&(i=""),i}var n=e.substring(5),s=JSON.parse(n);return i=s.data.delta,"**"==i&&(i=""),i},fetchAndProcessStream:function(e,t){var i=this;return(0,s.default)((0,n.default)().mark((function a(){var s,o,r,c,d,l,u,h,p;return(0,n.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=i,s.response="",a.prev=2,a.next=5,fetch(e,t);case 5:if(o=a.sent,o.body.locked||!o.ok){a.next=48;break}r=o.body.getReader();case 8:if(!s.isStopped){a.next=12;break}return r.releaseLock(),a.abrupt("break",41);case 12:return a.prev=12,a.next=15,r.read();case 15:if(c=a.sent,d=c.done,l=c.value,!d){a.next=20;break}return a.abrupt("break",41);case 20:if(u=(new TextDecoder).decode(l),!u.includes('"delta":"<|code_start|>"')){a.next=26;break}return console.log("结束"),a.abrupt("break",41);case 26:return a.next=28,s.getDelta(u);case 28:h=a.sent,console.log(h),s.response+=h,s.last=!0;case 32:a.next=39;break;case 34:return a.prev=34,a.t0=a["catch"](12),console.log(a.t0),r.releaseLock(),a.abrupt("break",41);case 39:a.next=8;break;case 41:s.getTtoA(s.response),p=JSON.stringify(s.response),console.log(p),uni.request({url:"https://www.tuozhen.com/application-usrapp/saveUserChatInfoPost.tz",method:"post",data:{userId:s.userId,message:s.response,type:0,aiType:s.aiType},success:function(e){s.contentList.push({message:s.response}),s.$nextTick((function(){s.scrollToMessageId="message-"+(s.contentList.length-1),s.last=!1}))}}),s.isTall=!1,a.next=49;break;case 48:console.error("Response was not ok or the body was locked.");case 49:a.next=55;break;case 51:a.prev=51,a.t1=a["catch"](2),console.error("Fetch error:",a.t1),s.isStopped=!0;case 55:case"end":return a.stop()}}),a,null,[[2,51],[12,34]])})))()},sendBtn:function(e){var t=this;return(0,s.default)((0,n.default)().mark((function i(){var a,s,o,r,c,d;return(0,n.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(1!=t.payopen||0!=t.isMember){i.next=2;break}return i.abrupt("return");case 2:if(""!=t.inputMessage||1==e){i.next=4;break}return i.abrupt("return",uni.showToast({title:"请输入内容"}));case 4:if(t.isSend){i.next=6;break}return i.abrupt("return");case 6:return a=t,a.loading=!1,s="",1==e&&(s=a.audioSrc),o=1==e?a.text:t.inputMessage,r=1==e?Math.floor(a.elapsedTime):"",c="",1==e?(a.isTall=!0,c=2,a.contentList.push({isRead:!1,type:2,message:o,audioUrl:a.audioSrc,timeNum:r})):(c=1,a.contentList.push({type:1,message:o})),a.$nextTick((function(){a.scrollToMessageId="message-"+(a.contentList.length-1)})),a.$api.common.getSave(a.userId,c,encodeURIComponent(o),a.aiType,r,s).then((function(e){a.audioSrc=""})),a.inputMessage="",a.controller=new AbortController,d={method:"post",headers:{Authorization:"Bearer "+a.jq,"Content-Type":"application/json"},body:JSON.stringify({model:a.id,stream:!0,session_id:a.session_id,content:o})},i.next=21,a.fetchAndProcessStream("https://api.sensenova.cn/v1/llm/chat-conversations",d);case 21:case"end":return i.stop()}}),i)})))()},copyText:function(e){this.inputMessage=e,this.showtext=!1}}};t.default=r},"73e1":function(e,t,i){"use strict";var a=i("29d8");e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(a)},"795c":function(e,t,i){"use strict";var a=i("8bdb"),n=i("db04").start,s=i("73e1");a({target:"String",proto:!0,forced:s},{padStart:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},"9ffd":function(e,t,i){"use strict";i.r(t);var a=i("611d"),n=i.n(a);for(var s in a)["default"].indexOf(s)<0&&function(e){i.d(t,e,(function(){return a[e]}))}(s);t["default"]=n.a},cab1:function(e,t,i){var a=i("c86c"),n=i("2ec5"),s=i("a167"),o=i("36719"),r=i("78f1");t=a(!1);var c=n(s),d=n(o),l=n(r);t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-bec0200c]{background-color:#f3f3f3}body.?%PAGE?%[data-v-bec0200c]{background-color:#f3f3f3}.voice_icon[data-v-bec0200c]{height:%?50?%;width:%?50?%;background-repeat:no-repeat;background-size:100%}.voice_icon_right[data-v-bec0200c]{background-image:url('+c+");margin-left:%?10?%}.voice_icon_right_an[data-v-bec0200c]{-webkit-animation:voiceAn_right-data-v-bec0200c 1s linear alternate infinite;animation:voiceAn_right-data-v-bec0200c 1s linear alternate infinite}@-webkit-keyframes voiceAn_right-data-v-bec0200c{0%{background-image:url("+d+")}50%{background-image:url("+l+")}100%{background-image:url("+c+")}}@keyframes voiceAn_right-data-v-bec0200c{0%{background-image:url("+d+")}50%{background-image:url("+l+")}100%{background-image:url("+c+")}}.voice_an[data-v-bec0200c]{width:%?300?%;height:%?300?%;position:fixed;z-index:9999;top:50%;left:50%;-webkit-transform:translate(-50%,-55%);transform:translate(-50%,-55%);background-color:rgba(41,41,41,.7);color:#fff;display:flex;flex-direction:column;align-items:center;text-align:center;border-radius:%?10?%}.voice_an .text[data-v-bec0200c]{padding-top:%?30?%}@-webkit-keyframes runVoice-data-v-bec0200c{0%{height:10%}20%{height:50%}50%{height:100%}80%{height:50%}100%{height:0%}}@keyframes runVoice-data-v-bec0200c{0%{height:10%}20%{height:50%}50%{height:100%}80%{height:50%}100%{height:0%}}.voice_an .wave[data-v-bec0200c]{width:%?6?%;height:100%;margin-left:%?10?%;border-radius:%?50?%;background-color:#999;vertical-align:middle;display:inline-block}.voice_an .voice_an_icon[data-v-bec0200c]{width:%?200?%;height:%?100?%;line-height:%?50?%;margin:%?50?% 0}.voice_an .voice_an_icon #one[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .1s;animation:runVoice-data-v-bec0200c .6s infinite .1s}.voice_an .voice_an_icon #two[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .3s;animation:runVoice-data-v-bec0200c .6s infinite .3s}.voice_an .voice_an_icon #three[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .6s;animation:runVoice-data-v-bec0200c .6s infinite .6s}.voice_an .voice_an_icon #four[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .1s;animation:runVoice-data-v-bec0200c .6s infinite .1s}.voice_an .voice_an_icon #five[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .3s;animation:runVoice-data-v-bec0200c .6s infinite .3s}.voice_an .voice_an_icon #six[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .6s;animation:runVoice-data-v-bec0200c .6s infinite .6s}.voice_an .voice_an_icon #seven[data-v-bec0200c]{-webkit-animation:runVoice-data-v-bec0200c .6s infinite .1s;animation:runVoice-data-v-bec0200c .6s infinite .1s}.waveform[data-v-bec0200c]{width:100%;height:%?300?%;background-color:#f3f3f3;margin-top:%?150?%;position:relative;display:flex;justify-content:center;align-items:center}.waveform .avoiceprint-music[data-v-bec0200c]{height:%?120?%;width:60%;overflow:hidden;display:flex;justify-content:space-between;align-items:center}.bar[data-v-bec0200c]{width:%?8?%;border-radius:%?6?%;background-color:#333;-webkit-animation:movement-data-v-bec0200c 1.5s ease-in-out infinite;animation:movement-data-v-bec0200c 1.5s ease-in-out infinite}\n/* 定义动画 */@-webkit-keyframes movement-data-v-bec0200c{0%, 100%{height:%?60?%}50%{height:%?100?%}}@keyframes movement-data-v-bec0200c{0%, 100%{height:%?60?%}50%{height:%?100?%}}\n/* 为每个柱子设置不同的延迟时间，以形成波动效果 */.bar[data-v-bec0200c]:nth-child(1){-webkit-animation-delay:.3s;animation-delay:.3s}.bar[data-v-bec0200c]:nth-child(2){-webkit-animation-delay:.9s;animation-delay:.9s}.bar[data-v-bec0200c]:nth-child(3){-webkit-animation-delay:.86s;animation-delay:.86s}.bar[data-v-bec0200c]:nth-child(4){-webkit-animation-delay:1s;animation-delay:1s}.bar[data-v-bec0200c]:nth-child(5){-webkit-animation-delay:.6s;animation-delay:.6s}.bar[data-v-bec0200c]:nth-child(6){-webkit-animation-delay:.8s;animation-delay:.8s}.bar[data-v-bec0200c]:nth-child(7){-webkit-animation-delay:.4s;animation-delay:.4s}.bar[data-v-bec0200c]:nth-child(8){-webkit-animation-delay:.7s;animation-delay:.7s}.bar[data-v-bec0200c]:nth-child(9){-webkit-animation-delay:.3s;animation-delay:.3s}.bar[data-v-bec0200c]:nth-child(10){-webkit-animation-delay:.1s;animation-delay:.1s}.bar[data-v-bec0200c]:nth-child(11){-webkit-animation-delay:.4s;animation-delay:.4s}.bar[data-v-bec0200c]:nth-child(12){-webkit-animation-delay:.2s;animation-delay:.2s}.bar[data-v-bec0200c]:nth-child(13){-webkit-animation-delay:.6s;animation-delay:.6s}.bar[data-v-bec0200c]:nth-child(14){-webkit-animation-delay:1s;animation-delay:1s}.bar[data-v-bec0200c]:nth-child(15){-webkit-animation-delay:.5s;animation-delay:.5s}.bar[data-v-bec0200c]:nth-child(16){-webkit-animation-delay:.8s;animation-delay:.8s}.bar[data-v-bec0200c]:nth-child(17){-webkit-animation-delay:.5s;animation-delay:.5s}.bar[data-v-bec0200c]:nth-child(18){-webkit-animation-delay:.3s;animation-delay:.3s}.bar[data-v-bec0200c]:nth-child(19){-webkit-animation-delay:.6s;animation-delay:.6s}.bar[data-v-bec0200c]:nth-child(20){-webkit-animation-delay:1s;animation-delay:1s}.info[data-v-bec0200c]{border-radius:%?20?%;background-color:#f6f6f6;width:80%;height:%?124?%;margin:auto;line-height:2}.down[data-v-bec0200c]{display:flex;justify-content:space-between;max-width:70%;margin-left:16vw;margin-top:%?15?%}.answer[data-v-bec0200c]{border-radius:%?20?%;\n  /* background-color: #fff; */max-width:70%;padding:%?-10?%;line-height:1.5;color:#fff}.showtext[data-v-bec0200c]{position:absolute;bottom:%?300?%;left:%?40?%;display:flex;flex-direction:column}.copytext[data-v-bec0200c]{line-height:2;background-color:#f0f8ff;color:#000;padding:%?10?% %?30?%;border-radius:%?16?%;border:%?1?% solid #e5e5e5;margin:%?10?%}.case[data-v-bec0200c]{display:flex;flex-direction:row-reverse;align-items:center;margin-bottom:%?20?%;margin-right:%?30?%}.input[data-v-bec0200c]{width:70vw;\n  /* margin-left: 2.5vw; */display:flex;align-items:center;justify-content:space-between;padding:%?5?%;padding-left:%?10?%;padding-right:%?10?%;box-sizing:border-box;background-color:#f3f3f3;border-radius:%?25?%;border:%?1?% solid #d3d3d3}.news[data-v-bec0200c]{height:%?200?%;font-size:14px;padding:%?32?%;display:inline-block;margin-top:%?10?%;line-height:%?108?%;position:relative;top:0}.btnAll[data-v-bec0200c]{margin-top:%?10?%;display:flex;justify-content:flex-end}.btn[data-v-bec0200c]{width:%?130?%;height:%?44?%;opacity:1;border-radius:%?50?%;border:%?1?% solid #2fb4fb;display:flex;justify-content:center;align-items:center;color:#2fb4fb}.btn1[data-v-bec0200c]{margin-left:%?20?%;width:%?130?%;height:%?44?%;opacity:1;border-radius:%?50?%;background:linear-gradient(180deg,#79e2fc,#2691fc),#ccc;display:flex;justify-content:center;align-items:center;color:#fff}.news[data-v-bec0200c]{height:%?62?%;font-size:14px;padding:0 %?32?%;width:%?550?%;margin-top:%?10?%;line-height:%?48?%;top:0}.formatted-text[data-v-bec0200c]{white-space:pre-wrap}.other_func[data-v-bec0200c]{width:100%;height:%?160?%;display:flex}.other_func_X[data-v-bec0200c]{height:%?128?%}.other_func uni-image[data-v-bec0200c]{width:%?42?%;height:%?40?%}.content[data-v-bec0200c]{width:%?702?%;padding:%?20?% 10;opacity:1;border-radius:%?16?%;background:#fff;box-shadow:%?16?% 4px 41px rgba(85,85,85,.1)}.uppdf[data-v-bec0200c]{padding:0 %?30?%;margin:auto;width:%?552?%;height:%?90?%;opacity:1;border-radius:%?16?%;background:#fff;border:%?1?% dashed #a6a6a6;box-shadow:%?16?% %?4?% %?41?% rgba(85,85,85,.1);display:flex;justify-content:center;align-items:center}.zxfg[data-v-bec0200c]{\n  /* margin-top: 30rpx; */margin:%?20?%;width:%?106?%;height:%?112?%;opacity:1;border-radius:%?16?%;\n  /* border: 1rpx solid rgba(47, 180, 251, 1); */border:%?1?% solid #e5e5e5;display:flex;flex-direction:column;align-items:center;justify-content:center}.btnnow[data-v-bec0200c]{width:%?459?%;height:%?100?%;color:#fff;display:flex;align-items:center;justify-content:center;margin:auto;opacity:1;border-radius:%?60?%;background:linear-gradient(180deg,#79e2fc,#2691fc),linear-gradient(90deg,#ccc,hsla(0,0%,80%,0));box-shadow:%?-3?% %?3?% %?11?% rgba(47,180,251,.5);margin-bottom:%?30?%}.content[data-v-bec0200c]{width:90%;margin:auto;background-color:#e5e5e5;border-radius:%?16?%}.vip[data-v-bec0200c]{display:flex;flex-direction:column;align-items:center;position:absolute;top:%?10?%;left:24vw;color:#0081c7}.tao1[data-v-bec0200c]{margin:auto;width:%?618?%;height:%?153?%;opacity:1;border-radius:16px;background:rgba(47,180,251,.3);order:2px solid #2fb4fb}.cztj[data-v-bec0200c]{background-color:#ff631a;padding:%?0?% %?20?% %?10?% %?20?%;border-radius:%?16?% %?14.55?% %?30?% %?0?%}.taoList[data-v-bec0200c]{display:flex;flex-direction:column;justify-content:space-between;margin:auto;width:%?618?%;margin-top:%?20?%;height:%?153?%;opacity:1;border-radius:%?25?%;background:#fff;border:2px solid #e9e9e9}.after[data-v-bec0200c]{padding-bottom:%?8?%;text-align:center;opacity:1;border-radius:%?0?% %?0?% %?25?% %?25?%;background:#c1e9fe;color:#0081c7}.lin[data-v-bec0200c]{height:%?1?%;width:90%;background:#e9e9e9}.payType[data-v-bec0200c]{width:%?300?%;height:%?100?%;opacity:1;border-radius:%?16?%;background:#fef1e0;border:%?2?% solid #2fb4fb;align-items:center}.payType1[data-v-bec0200c]{width:%?300?%;height:%?100?%;opacity:1;border-radius:%?16?%;background:#fff;border:2px solid #eeedec;align-items:center}.checkimg[data-v-bec0200c]{position:absolute;width:%?45?%;top:%?-5?%;right:%?-5?%;border-radius:0 %?16?% 0 %?32?%}.paybtn[data-v-bec0200c]{margin:auto;width:%?630?%;height:%?100?%;opacity:1;border-radius:%?16?%;background:#ff631a;display:flex;align-items:center;justify-content:center}.showDel[data-v-bec0200c]{position:absolute;bottom:%?-120?%;background-color:#fff;padding:%?20?%;font-size:%?23?%;z-index:99;border-radius:%?10?%}.copyOrdel[data-v-bec0200c]{display:flex;justify-content:space-around;align-items:center;width:%?150?%}.single-user-chat[data-v-bec0200c]{margin-top:%?20?%;display:flex;flex-direction:column;align-items:end}.single-user-chat .user-message[data-v-bec0200c]{width:%?598?%;padding:%?24?% %?20?%;border-radius:%?24?% %?24?% 0 %?24?%;background:linear-gradient(127.96deg,#6585fa,#6ad5fe);display:flex;flex-direction:column}.single-user-chat .user-message .user-message-top[data-v-bec0200c]{display:flex;align-items:center;justify-content:space-between}.single-user-chat .user-message .user-message-top .title[data-v-bec0200c]{font-size:%?32?%;color:#fff;font-weight:700}.single-user-chat .user-message .user-message-top .user-audio-bag[data-v-bec0200c]{display:flex;align-items:center}.single-user-chat .user-message .user-message-top .user-audio-bag .play[data-v-bec0200c]{width:%?48?%;height:%?48?%;margin-right:%?20?%}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music[data-v-bec0200c]{width:%?120?%;display:flex;align-items:center;justify-content:space-evenly\n  /* 定义动画 */\n  /* 为每个柱子设置不同的延迟时间，以形成波动效果 */}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]{width:%?4?%;height:%?8?%;border-radius:%?6?%;background-color:#fff}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab-active[data-v-bec0200c]{-webkit-animation:musicMovement-data-v-bec0200c 1.5s ease-in-out infinite;animation:musicMovement-data-v-bec0200c 1.5s ease-in-out infinite}@-webkit-keyframes musicMovement-data-v-bec0200c{0%, 100%{height:%?8?%}50%{height:%?26?%}}@keyframes musicMovement-data-v-bec0200c{0%, 100%{height:%?8?%}50%{height:%?26?%}}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(1){-webkit-animation-delay:1s;animation-delay:1s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(2){-webkit-animation-delay:.9s;animation-delay:.9s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(3){-webkit-animation-delay:1s;animation-delay:1s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(4){-webkit-animation-delay:.7s;animation-delay:.7s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(5){-webkit-animation-delay:.3s;animation-delay:.3s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(6){-webkit-animation-delay:.6s;animation-delay:.6s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(7){-webkit-animation-delay:.4s;animation-delay:.4s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(8){-webkit-animation-delay:1s;animation-delay:1s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(9){-webkit-animation-delay:.2s;animation-delay:.2s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(10){-webkit-animation-delay:.4s;animation-delay:.4s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(11){-webkit-animation-delay:.6s;animation-delay:.6s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(12){-webkit-animation-delay:.7s;animation-delay:.7s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(13){-webkit-animation-delay:.3s;animation-delay:.3s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(14){-webkit-animation-delay:.6s;animation-delay:.6s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(15){-webkit-animation-delay:.9s;animation-delay:.9s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(16){-webkit-animation-delay:1s;animation-delay:1s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(17){-webkit-animation-delay:.7s;animation-delay:.7s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(18){-webkit-animation-delay:.3s;animation-delay:.3s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(19){-webkit-animation-delay:.6s;animation-delay:.6s}.single-user-chat .user-message .user-message-top .user-audio-bag .user-music .lab[data-v-bec0200c]:nth-child(20){-webkit-animation-delay:1s;animation-delay:1s}.single-user-chat .user-message .user-message-top .user-audio-bag .music-time[data-v-bec0200c]{margin-left:%?14?%;font-size:%?24?%;color:#fff}.single-user-chat .user-message .user-message-text[data-v-bec0200c]{margin-top:%?20?%;font-size:%?32?%;color:#fff;line-height:%?40?%;text-align:left;width:100%}",""]),e.exports=t},db04:function(e,t,i){"use strict";var a=i("bb80"),n=i("c435"),s=i("9e70"),o=i("f298"),r=i("862c"),c=a(o),d=a("".slice),l=Math.ceil,u=function(e){return function(t,i,a){var o,u,h=s(r(t)),p=n(i),g=h.length,m=void 0===a?" ":s(a);return p<=g||""===m?h:(o=p-g,u=c(m,l(o/m.length)),u.length>o&&(u=d(u,0,o)),e?h+u:u+h)}};e.exports={start:u(!1),end:u(!0)}},f298:function(e,t,i){"use strict";var a=i("497b"),n=i("9e70"),s=i("862c"),o=RangeError;e.exports=function(e){var t=n(s(this)),i="",r=a(e);if(r<0||r===1/0)throw new o("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(i+=t);return i}}}]);